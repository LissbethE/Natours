{"mappings":"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","sources":["public/js/index.js"],"sourcesContent":["/* eslint-disable */\r\n\r\nconst stripe = Stripe(\r\n  'pk_test_51NtJp2CMwuOVAK0FcnNQDqAUp7fWcavbJ4PqjbKAz0zSpOor2gZMDHprNOEy4TQRURR6QC5M2pTxRq5Grl6h1cRO00X1cCDvVs',\r\n);\r\n\r\n///////////////////////////////////\r\n// DOM ElEMENTS\r\n\r\nconst loginForm = document.querySelector('.form--login');\r\nconst signupForm = document.querySelector('.form--signup');\r\nconst logOutBtn = document.querySelector('.nav__el--logout');\r\nconst userDataForm = document.querySelector('.form-user-data');\r\nconst userPasswordForm = document.querySelector('.form-user-password');\r\nconst bookBtn = document.getElementById('book-tour');\r\n\r\n///////////////////////////////////\r\n// A L E R T\r\n\r\nexport const hideAlert = () => {\r\n  const el = document.querySelector('.alert');\r\n\r\n  if (el) el.parentElement.removeChild(el);\r\n};\r\n\r\n// Type is \"Success\" or \"Error\"\r\nexport const showAlert = (type, message) => {\r\n  hideAlert();\r\n\r\n  const markup = `<div class=\"alert alert--${type}\">${message}</div>`;\r\n  document.querySelector('body').insertAdjacentHTML('afterbegin', markup);\r\n\r\n  window.setTimeout(hideAlert, 5000);\r\n};\r\n\r\n///////////////////////////////////\r\n// Login And Logout\r\n\r\nconst login = async function (email, password) {\r\n  try {\r\n    const res = await axios({\r\n      method: 'POST',\r\n      url: '/api/v1/users/login',\r\n      data: {\r\n        email,\r\n        password,\r\n      },\r\n    });\r\n\r\n    if (res.data.status === 'success') {\r\n      showAlert('success', 'Logged in successfully! 🎉');\r\n      window.setTimeout(() => {\r\n        location.assign('/');\r\n      }, 1500);\r\n    }\r\n  } catch (err) {\r\n    showAlert('error', `${err.response.data.message}💥`);\r\n  }\r\n};\r\n\r\nconst singnup = async function (name, email, password, passwordConfirm) {\r\n  try {\r\n    // Date object\r\n    const date = new Date();\r\n    let currentDay = String(date.getDate()).padStart(2, '0');\r\n    let currentMonth = String(date.getMonth() + 1).padStart(2, '0');\r\n    let currentYear = date.getFullYear();\r\n\r\n    // we will display the date as DD-MM-YYYY\r\n    let currentDate = `${currentDay}-${currentMonth}-${currentYear}`;\r\n\r\n    const res = await axios({\r\n      method: 'POST',\r\n      url: '/api/v1/users/singnup',\r\n      data: {\r\n        name,\r\n        email,\r\n        password,\r\n        passwordConfirm,\r\n        rol: 'user',\r\n        passwordChangedAt: Number(currentDate),\r\n      },\r\n    });\r\n\r\n    if (res.data.status === 'success') {\r\n      showAlert('success', 'Logged in successfully! 🎉');\r\n\r\n      window.setTimeout(() => {\r\n        location.assign('/');\r\n      }, 1500);\r\n    }\r\n  } catch (err) {\r\n    showAlert('error', `${err.response.data.message}💥`);\r\n  }\r\n};\r\n\r\nconst logout = async () => {\r\n  try {\r\n    const res = await axios({\r\n      method: 'GET',\r\n      url: '/api/v1/users/logout',\r\n    });\r\n\r\n    if (res.data.status === 'success') location.reload(true);\r\n  } catch (err) {\r\n    showAlert('error', `💥Error logging out! 🔁Try again.`);\r\n  }\r\n};\r\n\r\n///////////////////////////////////\r\n// Update Settings\r\n\r\n// type is either \"password\" or \"date\"\r\nconst updateSettings = async function (data, type) {\r\n  try {\r\n    const url =\r\n      type === 'password'\r\n        ? '/api/v1/users/updateMyPassword'\r\n        : '/api/v1/users/updateMe';\r\n\r\n    const res = await axios({\r\n      method: 'patch',\r\n      url,\r\n      data,\r\n    });\r\n\r\n    if (res.data.status === 'success') {\r\n      showAlert('success', `${type} updated successfully! 🎉`);\r\n    }\r\n  } catch (err) {\r\n    showAlert('error', err.response.data.message);\r\n  }\r\n};\r\n\r\n///////////////////////////////////\r\n// Stripe\r\n\r\nexport const bookTour = async function (tourId) {\r\n  try {\r\n    // 1) Get checkout session from API\r\n    const session = await axios(`/api/v1/bookings/checkout-session/${tourId}`);\r\n\r\n    // 2) Create checkout form + chance credit card\r\n    await stripe.redirectToCheckout({ sessionId: session.data.session.id });\r\n  } catch (err) {\r\n    showAlert('error', `${err.response.data.message}💥`);\r\n  }\r\n};\r\n\r\n///////////////////////////////////\r\n///////////////////////////////////\r\nif (loginForm) {\r\n  loginForm.addEventListener('submit', (e) => {\r\n    e.preventDefault();\r\n\r\n    const email = document.getElementById('email').value;\r\n    const password = document.getElementById('password').value;\r\n\r\n    login(email, password);\r\n  });\r\n}\r\n\r\nif (signupForm) {\r\n  signupForm.addEventListener('submit', (e) => {\r\n    e.preventDefault();\r\n\r\n    const name = document.getElementById('name').value;\r\n    const email = document.getElementById('email').value;\r\n    const password = document.getElementById('password').value;\r\n    const passwordConfirm = document.getElementById('passwordConfirm').value;\r\n\r\n    singnup(name, email, password, passwordConfirm);\r\n  });\r\n}\r\n\r\nif (logOutBtn) {\r\n  logOutBtn.addEventListener('click', logout);\r\n}\r\n\r\n// Update Settings ----\r\nif (userDataForm) {\r\n  userDataForm.addEventListener('submit', function (e) {\r\n    e.preventDefault();\r\n\r\n    const form = new FormData();\r\n    form.append('name', document.getElementById('name').value);\r\n    form.append('email', document.getElementById('email').value);\r\n    form.append('photo', document.getElementById('photo').files[0]);\r\n\r\n    updateSettings(form, 'data');\r\n  });\r\n}\r\n\r\nif (userPasswordForm) {\r\n  userPasswordForm.addEventListener('submit', async function (e) {\r\n    e.preventDefault();\r\n\r\n    document.querySelector('.btn--save-password').textContent = 'Updating...';\r\n\r\n    const passwordCurrent = document.getElementById('password-current').value;\r\n    const password = document.getElementById('password').value;\r\n    const passwordConfirm = document.getElementById('password-confirm').value;\r\n\r\n    await updateSettings(\r\n      { passwordCurrent, password, passwordConfirm },\r\n      'password',\r\n    );\r\n\r\n    document.querySelector('.btn--save-password').textContent = 'Save password';\r\n\r\n    document.getElementById('password-current').value = '';\r\n    document.getElementById('password').value = '';\r\n    document.getElementById('password-confirm').value = '';\r\n  });\r\n}\r\n\r\n// Stripe ----\r\nif (bookBtn) {\r\n  bookBtn.addEventListener('click', function (e) {\r\n    e.target.textContent = 'Processing...';\r\n\r\n    const { tourId } = e.target.dataset;\r\n    bookTour(tourId);\r\n  });\r\n}\r\n"],"names":[],"version":3,"file":"module.js.map","sourceRoot":"../"}